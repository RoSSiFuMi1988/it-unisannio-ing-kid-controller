<!-- saved from url=(0022)http://internet.e-mail -->

<!DOCTYPE html>
<html>
  <head>
    <title>Google Maps JavaScript API v3 Example: Map Simple</title>
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta charset="UTF-8">
    <style type="text/css">
      html, body, #map_canvas {
        margin: 0;
        padding: 0;
        height: 90%;
      }
    </style>
    <script type="text/javascript"
        src="http://maps.googleapis.com/maps/api/js?key=AIzaSyAW-STbPNSoIc5irgEA8OsrCBYw-2aTT9A&sensor=false"></script>
    <script type="text/javascript">
      
    //variabili globali dello script
   	  var map1;
      var position;
      var circleSetRadius;
      var circleCancel;
      var circle;
      var position;
      var marker;
      var centra;
      
      //funzione initialize
      function initialize() {
   	  	position = new google.maps.LatLng(-34.397, 150.644);
        var myOptions = {
          zoom: 13,
          center: position,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map1 = new google.maps.Map(document.getElementById('map_canvas'),myOptions);
      }
        
       //setta il raggio del cerchio
       circleSetRadius = function() {
        	var raggio=document.getElementById('raggio');
        	
        	if(raggio.value != ""){
        		//quando si definisce un raggio, crea un cerchio se non esiste
        		if(!circle){
        			//opzioni di creazione del cerchio
        			var myCircOptions = {
        	        		center: position,
        	        		fillColor: 'LimeGreen',
        	        		strokeColor: 'LimeGreen',
        	        		fillOpacity: 0.2,
        	        		strokeOpacity: 0.2,
        	        		map: map1
        	        };
        			circle = new google.maps.Circle(myCircOptions);
        		}
	 			var metri = parseInt(raggio.value, 10);
	 			circle.setRadius(metri);
        	}        	
        }
        //mette il raggio a zero cosi cancella il cerchio
        cancel = function(){
        	if(circle){
        		circle.setRadius(0);
        		document.getElementById('raggio').value = "";       		
        	}
        	if(marker)
        		marker.setVisible(false);
        }
        
        //aggiunge un listner che centra mappa e cerchio dove si clicca
        google.maps.event.addListener(map1,'click', function(e){
        	position= e.latLng;
        	if(circle)
        		circle.setCenter(position);
        	if(!marker){
        		marker = new google.maps.Marker();
        		marker.setMap(map1);
        	}
        	if(!marker.getVisible())
        		marker.setVisible(true);
        	marker.setPosition(position);
        	document.getElementById('latText').value = position.lat();
        	document.getElementById('lonText').value = position.lng();
        	circleSetRadius();
        	
        });
        
        
      }
		
      
      
      google.maps.event.addDomListener(window, 'load', initialize());
      
    </script>
  </head>
  <body>
	<br>
	nome citta: <input type="text" id="citta"/>
  	<button onclick="centra()">Centra</button><br>
    <div id="map_canvas"></div>
 <form action="Impostazione2" method="get">
    Latitudine:<input type="text" id="latText" name="lat"/>
    Longitudine:<input type="text" id="lonText" name="lon"/><br/>
    Raggio in metri :<input type="number" id="raggio" name="raggio" onkeyup="circleSetRadius()"/>
    <input type="submit" value="Imposta"/>
</form>
<button onclick="cancel()">Cancel</button> 
  </body>
</html>

